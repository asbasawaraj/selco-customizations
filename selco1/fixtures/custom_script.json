[
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Lead", 
  "modified": "2016-04-01 16:44:01.900421", 
  "name": "Lead-Client", 
  "script": "/*To set naming series when branch is choosen for the first time */\ncur_frm.add_fetch(\"branch\", \"lead_naming_series\", \"naming_series\"); \n\n/*To set naming series when the value in branch is changed*/\nfrappe.ui.form.on(\"Lead\", \"branch\",\n    function(frm) {\ncur_frm.add_fetch(\"branch\", \"lead_naming_series\", \"naming_series\");\n\nif ( cur_frm.doc.naming_series == null )\n{\nwindow.location.reload();\nmsgprint(\"Please set the correct naming series for the branch.\");\n       throw \"Not allowed\";\n}\n})", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Opportunity", 
  "modified": "2016-04-02 10:16:12.336049", 
  "name": "Opportunity-Client", 
  "script": "/*To set naming series when branch is choosen for the first time */\ncur_frm.add_fetch(\"branch\", \"opportunity_naming_series\", \"naming_series\"); \n\n/*To set naming series when the value in branch is changed*/\nfrappe.ui.form.on(\"Opportunity\", \"branch\",\n    function(frm) {\ncur_frm.add_fetch(\"branch\", \"opportunity_naming_series\", \"naming_series\");\n\nif ( cur_frm.doc.naming_series == null )\n{\nwindow.location.reload();\nmsgprint(\"Please set the correct naming series for the branch.\");\n       throw \"Not allowed\";\n}\n})", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Quotation", 
  "modified": "2016-04-05 13:44:59.764805", 
  "name": "Quotation-Client", 
  "script": "/*To set naming series when branch is choosen for the first time */\ncur_frm.add_fetch(\"branch\", \"quotation_naming_series\", \"naming_series\"); \n\n/*To set naming series when the value in branch is changed*/\nfrappe.ui.form.on(\"Quotation\", \"branch\",\n    function(frm) {\ncur_frm.add_fetch(\"branch\", \"quotation_naming_series\", \"naming_series\");\n\nif ( cur_frm.doc.naming_series == null )\n{\nwindow.location.reload();\nmsgprint(\"Please set the correct naming series for the branch.\");\n       throw \"Not allowed\";\n}\n})", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Sales Order", 
  "modified": "2016-04-02 10:18:12.052991", 
  "name": "Sales Order-Client", 
  "script": "/*To set naming series when branch is choosen for the first time */\ncur_frm.add_fetch(\"branch\", \"sales_order_naming_series\", \"naming_series\"); \n\n/*To set naming series when the value in branch is changed*/\nfrappe.ui.form.on(\"Sales Order\", \"branch\",\n    function(frm) {\ncur_frm.add_fetch(\"branch\", \"sales_order_naming_series\", \"naming_series\");\n\nif ( cur_frm.doc.naming_series == null )\n{\nwindow.location.reload();\nmsgprint(\"Please set the correct naming series for the branch.\");\n       throw \"Not allowed\";\n}\n})", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Material Request", 
  "modified": "2016-12-29 11:09:25.740576", 
  "name": "Material Request-Client", 
  "script": "frappe.ui.form.on(\"Material Request\", \"refresh\", function(frm) {\n\ncur_frm.set_value(\"material_request_type\",\"Material Transfer\");\n\n\n})\n\n/*To set naming series when branch is choosen for the first time */\ncur_frm.add_fetch(\"branch\", \"material_request_naming_series\", \"naming_series\"); \ncur_frm.add_fetch(\"branch\", \"branch_credit_limit\", \"branch_credit_limit\"); \n\ncur_frm.add_fetch(\"branch\", \"selco_senior_sales_manager_email_id\", \"selco_senior_sales_manager_email_id\"); \n\ncur_frm.add_fetch(\"branch\", \"godown_email_id\", \"godown_email_id\");\ncur_frm.add_fetch(\"branch\", \"agms_email_id\", \"agms_email_id\"); \n \n\n\n/*To set naming series when the value in branch is changed*/\nfrappe.ui.form.on(\"Material Request\", \"branch\",\n    function(frm) {\ncur_frm.add_fetch(\"branch\", \"material_request_naming_series\", \"naming_series\");\n\nif ( cur_frm.doc.naming_series == null )\n{\nwindow.location.reload();\nmsgprint(\"Please set the correct naming series for the branch.\");\n       throw \"Not allowed\";\n}\n})\n\nfrappe.ui.form.on(\"Material Request\", \"refresh\", function(frm) {\n\ncur_frm.fields_dict['items'].grid.get_field('warehouse').get_query = function(doc) {\nreturn {\n          \"filters\": {\n          \"type\": \"Virtual\"\n          }\n\t}\n}\n});\n\nfrappe.ui.form.on(\"Material Request\", \"refresh\", function(frm) {\n\ncur_frm.fields_dict['items'].grid.get_field('item_code').get_query = function(doc) {\nreturn {\n          \"filters\": {\n          \"is_stock_item\": \"1\"\n          }\n\t}\n}\n});\n\nfrappe.ui.form.on(\"Material Request\", \"refresh\",\n    function(frm) {\nif ([\"Approval Pending by SM - IBM\",\"Approval Pending by AGM - IBM\",\"Approved - IBM\",\"Partially Dispatched From Godown - IBM\",\"Dispatched From Godown - IBM\"].indexOf(cur_frm.doc.workflow_state) > -1)\n{\ncur_frm.fields.forEach(function(l){ cur_frm.set_df_property(l.df.fieldname, \"read_only\", 1); })\nfrm.set_df_property(\"dc_number\", \"read_only\",0);\nfrm.set_df_property(\"dc_date\", \"read_only\",0);\nfrm.set_df_property(\"godown_oa_comments\", \"read_only\",0);\n}\n})\n\n\nfrappe.ui.form.on(\"Material Request\", \"validate\", function(frm) {\ncur_frm.doc.total_of_stock_and_debtors = cur_frm.doc.present_debtors+cur_frm.doc.stock_value\ncur_frm.doc.present_limit = cur_frm.doc.branch_credit_limit-cur_frm.doc.total_of_stock_and_debtors\n\n});\n\n\n\n\nfrappe.ui.form.on(\"Material Request\", \"validate\", function(frm) {\n\ncur_frm.clear_table(\"items_print\");\ncur_frm.refresh()\nvar flag=0;\n\nvar newrow = frappe.model.add_child(cur_frm.doc,\"Material Request Item Print\", \"items_print\");\nnewrow.item_code = cur_frm.doc.items[0].item_code\nnewrow.item_name = cur_frm.doc.items[0].item_name\nnewrow.quantity = cur_frm.doc.items[0].qty\n\n\nfor (i = 1; i < cur_frm.doc.items.length; i++) { \nfor (j = 0; j < cur_frm.doc.items_print.length; j++) { \nif (cur_frm.doc.items[i].item_code == cur_frm.doc.items_print[j].item_code && cur_frm.doc.items[i].item_name == cur_frm.doc.items_print[j].item_name)\n{\nflag = 1;\ncur_frm.doc.items_print[j].quantity = cur_frm.doc.items_print[j].quantity +cur_frm.doc.items[i].qty;\nrefresh_field(\"items_print\");\n}\n}\nif(flag != 1)\n{\nvar newrow = frappe.model.add_child(cur_frm.doc,\"Material Request Item Print\", \"items_print\");\nnewrow.item_code = cur_frm.doc.items[i].item_code\nnewrow.item_name = cur_frm.doc.items[i].item_name\nnewrow.quantity = cur_frm.doc.items[i].qty\n}\nflag=0;\n}\n});\n\n\n\n\n", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Stock Entry", 
  "modified": "2016-12-27 16:27:03.891566", 
  "name": "Stock Entry-Client", 
  "script": "/*To set naming series when branch is choosen for the first time */\ncur_frm.add_fetch(\"from_warehouse\", \"stock_entry_naming_series\", \"naming_series\"); \ncur_frm.add_fetch(\"branch\", \"git_warehouse\", \"to_warehouse\"); \n\n\n/*To set naming series when the value in branch is changed*/\nfrappe.ui.form.on(\"Stock Entry\", \"branch\",\n    function(frm) {\ncur_frm.add_fetch(\"branch\", \"stock_entry_naming_series\", \"naming_series\");\n\nif ( cur_frm.doc.naming_series == null )\n{\nwindow.location.reload();\nmsgprint(\"Please set the correct naming series for the branch.\");\n       throw \"Not allowed\";\n}\n})\n\nfrappe.ui.form.on(\"Stock Entry\", \"to_warehouse\", function(frm, cdt, cdn) {\n\tvar d = locals[cdt][cdn];\n\tfrappe.call({\n\t\t\"method\": \"frappe.client.get\",\n\t\targs: {\n\t\t\tdoctype: \"Warehouse\",\n\t\t\tname: d.to_warehouse\n\t\t},\n\t\tcallback: function (data) {\n\t\t\tfrappe.model.set_value(d.doctype, d.name, \"branch_address_link\",data.message.address);\n\n\t\t}\n\t})\n});\n\nfrappe.ui.form.on(\"Stock Entry\", \"branch_address_link\", function(frm, cdt, cdn) {\n        return frm.call({\n            method: \"erpnext.utilities.doctype.address.address.get_address_display\",\n            args: {\n                \"address_dict\": frm.doc.branch_address_link\n            },\n            callback: function(r) {\n            if(r.message) {\n             frappe.model.set_value(cdt,cdn,\"branch_address\", r.message);\n        }\n        }});\n     \n})\n\nfrappe.ui.form.on(\"Stock Entry\", \"validate\", function(frm, cdt, cdn) {\nif ( cur_frm.doc.purpose == \"Repack\" )\n{\ncur_frm.doc.naming_series=\"REPACK/.####\";\ncur_frm.set_value(\"to_warehouse\",cur_frm.doc.from_warehouse)\n\n}\n})\n\ncur_frm.cscript.custom_purpose = function(doc, cdt, cd){\n\ncur_frm.set_df_property(\"to_warehouse\", \"read_only\",1);\n\n if(user==\"northgodown@selco-india.com\" && frm.doc.purpose==\"Repack\") {\ncur_frm.set_value(\"from_warehouse\",\"Dharwad Godown - SELCO\")\n}else if (user==\"southgodown@selco-india.com\" && frm.doc.purpose==\"Repack\")\n{\ncur_frm.set_value(\"from_warehouse\",\"Manipal Godown - SELCO\")\n}else if (user==\"bangalore_godown@selco-india.com\" && frm.doc.purpose==\"Repack\")\n{\ncur_frm.set_value(\"from_warehouse\",\"Bangalore Godown - SELCO\")\n}\n }", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Delivery Note", 
  "modified": "2016-04-02 10:22:40.607483", 
  "name": "Delivery Note-Client", 
  "script": "/*To set naming series when branch is choosen for the first time */\ncur_frm.add_fetch(\"branch\", \"delivery_note_naming_series\", \"naming_series\"); \n\n/*To set naming series when the value in branch is changed*/\nfrappe.ui.form.on(\"Delivery Note\", \"branch\",\n    function(frm) {\ncur_frm.add_fetch(\"branch\", \"delivery_note_naming_series\", \"naming_series\");\n\nif ( cur_frm.doc.naming_series == null )\n{\nwindow.location.reload();\nmsgprint(\"Please set the correct naming series for the branch.\");\n       throw \"Not allowed\";\n}\n})", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Sales Invoice", 
  "modified": "2016-04-09 15:49:09.215283", 
  "name": "Sales Invoice-Client", 
  "script": "cur_frm.add_fetch(\"branch\", \"sales_invoice_naming_series\",\"custom_si_naming_series\");\ncur_frm.add_fetch(\"branch\", \"service_bill_naming_series\",\"custom_sb_naming_series\");\n\n\n/*To set naming series when the value in branch is changed*/\nfrappe.ui.form.on(\"Sales Invoice\", \"branch\",\n    function(frm) {\ncur_frm.add_fetch(\"branch\", \"sales_invoice_naming_series\",\"custom_si_naming_series\");\ncur_frm.add_fetch(\"branch\", \"service_bill_naming_series\",\"custom_sb_naming_series\");\n\nif ( ( cur_frm.doc.custom_si_naming_series == null ) || ( cur_frm.doc.custom_sb_naming_series == null ) )\n{\nwindow.location.reload();\nmsgprint(\"Please set the correct naming series for the branch.\");\n       throw \"Not allowed\";\n}\n})\n\nfrappe.ui.form.on(\"Sales Invoice\", \"type_of_invoice\",\n    function(frm) {\nif ( cur_frm.doc.type_of_invoice == \"System Sales Invoice\" )\n{\ncur_frm.set_value(\"naming_series\",cur_frm.doc.custom_si_naming_series);\ncur_frm.set_df_property(\"service_bill_no\", \"reqd\", true);\ncur_frm.set_df_property(\"delivery_note\", \"reqd\", true);\n} else if( cur_frm.doc.type_of_invoice == \"Spare Sales Invoice\" )\n{\ncur_frm.set_value(\"naming_series\",cur_frm.doc.custom_si_naming_series);\ncur_frm.set_df_property(\"service_bill_no\", \"reqd\", false);\ncur_frm.set_df_property(\"delivery_note\", \"reqd\", true);\n}\nelse if (cur_frm.doc.type_of_invoice == \"Service Bill\")\n{\ncur_frm.set_value(\"naming_series\",cur_frm.doc.custom_sb_naming_series);\ncur_frm.set_df_property(\"service_bill_no\", \"reqd\", false);\ncur_frm.set_df_property(\"delivery_note\", \"reqd\", false);\n}\n})\n\nfrappe.ui.form.on(\"Sales Invoice\", \"refresh\", function(frm) {\n    cur_frm.set_query(\"service_bill_no\", function() {\n        return {\n            \"filters\": {\n                \"customer\": frm.doc.customer,\n                \"type_of_invoice\": \"Service Bill\"\n            }\n        };\n    });\n});\n\n\nfrappe.ui.form.on(\"Sales Invoice\", \"type_of_invoice\", function(frm) {\n\nif ( cur_frm.doc.type_of_invoice == \"Service Bill\")\n{\ncur_frm.fields_dict['items'].grid.get_field('item_code').get_query = function(doc) {\nreturn {\n\n\t\tfilters: [\n                         ['item_group', 'in', 'Installation Charges,AMC,Service Charges']\n\t\t\t\n\t\t]\n\t}\n}\n}\n});\n\n", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Customer", 
  "modified": "2016-04-06 09:49:03.493887", 
  "name": "Customer-Client", 
  "script": "/*To set naming series when branch is choosen for the first time */\ncur_frm.add_fetch(\"branch\", \"customer_naming_series\", \"naming_series\"); \n\n/*To set naming series when the value in branch is changed*/\nfrappe.ui.form.on(\"Lead\", \"branch\",\n    function(frm) {\ncur_frm.add_fetch(\"branch\", \"customer_naming_series\", \"naming_series\");\n\nif ( cur_frm.doc.naming_series == null )\n{\nwindow.location.reload();\nmsgprint(\"Please set the correct naming series for customers in branch record.\");\n       throw \"Not allowed\";\n}\n})", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Product Bundle", 
  "modified": "2016-04-06 16:34:50.164595", 
  "name": "Product Bundle-Client", 
  "script": "frappe.ui.form.on(\"Product Bundle\", \"validate\", function(frm, cdt, cdn) {\nvar d =locals[cdt][cdn]\n\nif (d.type == \"Standard - As per Price List\")\n{\n\nmsgprint(\"You cannot change Standard system configuration\");\n       throw \"Not allowed\";\n}\n});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Journal Entry", 
  "modified": "2016-04-15 15:36:50.690714", 
  "name": "Journal Entry-Client", 
  "script": "/*To set naming series when branch is choosen for the first time */\ncur_frm.add_fetch(\"branch\", \"receipt_naming_series\", \"naming_series\"); \n\n/*To set naming series when the value in branch is changed*/\nfrappe.ui.form.on(\"Journal Entry\", \"branch\",\n    function(frm) {\ncur_frm.add_fetch(\"branch\", \"receipt_naming_series\", \"naming_series\");\n\nif ( cur_frm.doc.naming_series == null )\n{\nwindow.location.reload();\nmsgprint(\"Please set the correct naming series for the branch.\");\n       throw \"Not allowed\";\n}\n})", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Purchase Order", 
  "modified": "2016-12-12 11:23:58.133785", 
  "name": "Purchase Order-Client", 
  "script": "/*To set naming series when branch is choosen for the first time */\ncur_frm.add_fetch(\"godown\", \"po_naming_series\", \"naming_series\"); \n\ncur_frm.add_fetch(\"godown\", \"godown_email\", \"godown_email\"); \n\nfrappe.ui.form.on(\"Purchase Order\", \"godown_address\", function(frm, cdt, cdn) {\n        return frm.call({\n            method: \"erpnext.utilities.doctype.address.address.get_address_display\",\n            args: {\n                \"address_dict\": frm.doc.godown_address\n            },\n            callback: function(r) {\n            if(r.message) {\n           /*  console.log(r.message);*/                   \n             frappe.model.set_value(cdt,cdn,\"godown_address_details\", r.message);\n            /* $(frm.fields_dict.detail_address.wrapper).html(r.message) */  }\n        }\n        });\n     \n})\n\n\ncur_frm.add_fetch(\"supplier\", \"suppliers_vat_tin\", \"suppliers_vat_tin\"); \n\ncur_frm.add_fetch(\"supplier\", \"credit_days\", \"mode_terms_of_payment\");\n\ncur_frm.add_fetch(\"supplier\", \"terms_and_conditions\", \"tc_name\");\n\ncur_frm.add_fetch(\"godown\", \"address\", \"godown_address\");\n\n\n\n\nfrappe.ui.form.on(\"Purchase Order\", \"validate\", function(frm) \n{\nvar advance_local = cur_frm.doc.base_rounded_total * ( cur_frm.doc.advance_percentage_1 / 100 ) ;\nadvance_local = Math.floor(advance_local);\nvar balance_local = cur_frm.doc.base_rounded_total - advance_local ;\n\ncur_frm.set_value(\"advance_details_currency\",advance_local);\ncur_frm.set_value(\"balance_details_currency\",balance_local);\n})\n\n\nfrappe.ui.form.on(\"Purchase Order\", \"refresh\",\n    function(frm) {\nif ( cur_frm.doc.workflow_state == \"AGM Approval Pending - PO\" || cur_frm.doc.workflow_state == \"Logistics Manager Approval Pending - PO\" || cur_frm.doc.workflow_state == \"Accounts Approval Pending - PO\")\n{\ncur_frm.fields.forEach(function(l){ cur_frm.set_df_property(l.df.fieldname, \"read_only\", 1); })\n}\n})\n\nfrappe.ui.form.on(\"Purchase Order\", \"refresh\", function(frm) {\n    cur_frm.set_query(\"godown\", function() {\n        return {\n            \"filters\": {\n                \"type\": \"Godown\"\n            }\n        };\n    });\n});\n\nfrappe.ui.form.on(\"Purchase Order Item\",\"item_code\",function(frm,cdt,cdn){\nvar d = locals[cdt][cdn];\nd.warehouse = cur_frm.doc.godown;\nfrm.set_df_property(\"godown\", \"read_only\",1);\n});\n\nfrappe.ui.form.on(\"Purchase Order\",\"validate\",function(frm,cdt,cdn){\nop = cur_frm.doc.items\nfor(var i=0; i < op.length; i++) {\nif(op[i].warehouse == cur_frm.doc.godown){\n} else\n{\nconsole.log(\"error message\");\nfrappe.throw(\"Please choose same warehouse for all items\");\n}\n}\n});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Issue", 
  "modified": "2016-12-19 20:09:07.343886", 
  "name": "Issue-Client", 
  "script": "/*To set naming series when branch is choosen for the first time */\ncur_frm.add_fetch(\"branch\", \"customer_complaint_naming_series\", \"naming_series\"); \n\n\n/*To set Branch eMail ID when branch is choosen for the first time */\ncur_frm.add_fetch(\"branch\", \"branch_email_id\", \"branch_email_id\"); \ncur_frm.add_fetch(\"branch\", \"service_branch_email_id\", \"service_branch_email_id\"); \n\n\n/*To set naming series when the value in branch is changed*/\nfrappe.ui.form.on(\"Issue\", \"branch\",\n    function(frm) {\ncur_frm.add_fetch(\"branch\", \"customer_complaint_naming_series\", \"naming_series\");\n\nif ( cur_frm.doc.naming_series == null )\n{\nwindow.location.reload();\nmsgprint(\"Please set the correct naming series for the branch.\");\n       throw \"Not allowed\";\n}\n})\n\ncur_frm.add_fetch(\"customer_name_custom\", \"customer_contact_number\", \"customer_contact_number\");\ncur_frm.add_fetch(\"customer_name_custom\", \"customer_name\", \"customer_full_name\");\ncur_frm.add_fetch(\"complaint_handled_by\", \"service_person_name\", \"service_person_name\");\n\n/*To 'Make Fields Read Only' once the workflow state changes to anything other than 'Complaint Drafted'*/\nfrappe.ui.form.on(\"Issue\", \"refresh\",\n    function(frm) {\nif ( cur_frm.doc.workflow_state == \"Complaint Open\" || cur_frm.doc.workflow_state == \"Complaint Assigned To CSE\" || cur_frm.doc.workflow_state == \"Complaint Cancelled\" || cur_frm.doc.workflow_state == \"Complaint Attended By CSE - Still Open\" || cur_frm.doc.workflow_state == \"Complaint Escalated To SBM\" || cur_frm.doc.workflow_state == \"Complaint Closed By Branch\" || cur_frm.doc.workflow_state == \"Complaint Closed By CSD\" || cur_frm.doc.workflow_state == \"Warranty Claim Format Raised - WC\" || cur_frm.doc.workflow_state == \"Dispatch Pending From Godown\" || cur_frm.doc.workflow_state == \"Dispatched From Godown\")\n{\nfrm.set_df_property(\"date\", \"read_only\",1);\nfrm.set_df_property(\"branch\", \"read_only\",1);\nfrm.set_df_property(\"subject\", \"read_only\",1);\nfrm.set_df_property(\"description_of_complaint\", \"read_only\",1);\nfrm.set_df_property(\"customer_name_custom\", \"read_only\",1);\nfrm.set_df_property(\"customer_full_name\", \"read_only\",1);\n\nfrm.set_df_property(\"customer_contact_number\", \"read_only\",1);\nfrm.set_df_property(\"customer_address\", \"read_only\",1);\nfrm.set_df_property(\"complaint_priority\", \"read_only\",1);\nfrm.set_df_property(\"warranty_applicable\", \"read_only\",1);\nfrm.set_df_property(\"type_of_system\", \"read_only\",1);\nfrm.set_df_property(\"capacity\", \"read_only\",1);\n}\n})\n\n/*To 'Make Fields Read Only' once the workflow state changes to 'closed by branch' or 'closed by CSD'*/\nfrappe.ui.form.on(\"Issue\", \"refresh\",\n    function(frm) {\nif ( cur_frm.doc.workflow_state == \"Complaint Closed By CSD\" || cur_frm.doc.workflow_state == \"Complaint Closed By Branch\" || cur_frm.doc.workflow_state == \"Dispatch Pending From Godown\")\n{\nfrm.set_df_property(\"ics_number\", \"read_only\",1);\nfrm.set_df_property(\"category_of_complaint\", \"read_only\",1);\nfrm.set_df_property(\"faulty_component\", \"read_only\",1);\nfrm.set_df_property(\"service_record_number\", \"read_only\",1);\nfrm.set_df_property(\"branch_remarks\", \"read_only\",1);\nfrm.set_df_property(\"rcse_name_if_involved\", \"read_only\",1);\n\nfrm.set_df_property(\"ics_date\", \"read_only\",1);\nfrm.set_df_property(\"complaint_handled_by\", \"read_only\",1);\nfrm.set_df_property(\"component_vendor\", \"read_only\",1);\nfrm.set_df_property(\"record_date\", \"read_only\",1);\nfrm.set_df_property(\"service_charges_collected\", \"read_only\",1);\nfrm.set_df_property(\"rcse_remarks\", \"read_only\",1);\n}\n})\n\nfrappe.ui.form.on(\"Issue\", \"customer_name_custom\", function(frm) {\n    cur_frm.set_query(\"customer_address\", function() {\n        return {\n            \"filters\": {\n                \"customer\": frm.doc.customer_name_custom\n            }\n        };\n    });\n});\n\nfrappe.ui.form.on(\"Issue\", \"customer_address\", function(frm, cdt, cdn) {\n        return frm.call({\n            method: \"erpnext.utilities.doctype.address.address.get_address_display\",\n            args: {\n                \"address_dict\": frm.doc.customer_address\n            },\n            callback: function(r) {\n            if(r.message) {\n           /*  console.log(r.message);*/                   \n             frappe.model.set_value(cdt,cdn,\"detail_address\", r.message);\n            /* $(frm.fields_dict.detail_address.wrapper).html(r.message) */  }\n        }\n        });\n     \n})\n\nfrappe.ui.form.on(\"Issue\", \"refresh\", function (frm, cdt, cdn) {\n  cur_frm.set_query(\"customer_name_custom\", function () {\n    return { \n      query: \"erpnext.controllers.queries.customer_query\",\n      searchfield: \"customer_contact_number\"\n    }\n  });\n});\n\nfrappe.ui.form.on(\"Issue\", \"refresh\",\n    function(frm) {\nif ( cur_frm.doc.workflow_state == \"Complaint Closed By CSD\" || cur_frm.doc.workflow_state == \"Complaint Rejected By CSD\" )\n{\nfrm.set_df_property(\"remarks\", \"read_only\",1);\nfrm.set_df_property(\"special_budget\", \"read_only\",1);\n}\n})\n\n\nfrappe.ui.form.on(\"Issue\", \"validate\", function(frm, cdt, cdn) {\ncur_frm.doc.sms_number = cur_frm.doc.customer_contact_number + \"@sms.textlocal.in\";\n})", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Service Person", 
  "modified": "2016-06-23 12:00:41.084797", 
  "name": "Service Person-Client", 
  "script": "//cur_frm.add_fetch(\"employee\", \"employee_name\", \"service_person_name\"); ", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Purchase Receipt", 
  "modified": "2016-12-02 23:16:19.849745", 
  "name": "Purchase Receipt-Client", 
  "script": "\nfrappe.ui.form.on(\"Purchase Receipt\", \"refresh\", function(frm) {\n\tif(frm.doc.godown) {\n\t\tfrm.call({\n\t\t\tmethod: \"frappe.client.get_value\",\n\t\t\targs: {\n\t\t\t\tdoctype: \"Warehouse\",\n\t\t\t\tfieldname: \"mrn_naming_series\",\n\t\t\t\tfilters: { name: frm.doc.godown },\n\t\t\t},\n\t\t\tcallback: function(r, rt) {\n\t\t\t\tif(r.message) {\n\t\t\t\t\tfrm.set_value(\"naming_series\", r.message.mrn_naming_series);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n})\n\nfrappe.ui.form.on(\"Purchase Receipt\", \"godown\", function(frm) {\n\tif(frm.doc.godown) {\n\t\tfrm.call({\n\t\t\tmethod: \"frappe.client.get_value\",\n\t\t\targs: {\n\t\t\t\tdoctype: \"Warehouse\",\n\t\t\t\tfieldname: \"mrn_naming_series\",\n\t\t\t\tfilters: { name: frm.doc.godown },\n\t\t\t},\n\t\t\tcallback: function(r, rt) {\n\t\t\t\tif(r.message) {\n\t\t\t\t\tfrm.set_value(\"naming_series\", r.message.mrn_naming_series);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n})\n\n\nfrappe.ui.form.on(\"Purchase Receipt\",\"validate\",function(frm,cdt,cdn){\n\nfor(var i=0; i < cur_frm.doc.items.length; i++) \n{\ncur_frm.doc.items[i].warehouse = cur_frm.doc.godown; \n}\n\n\ncur_frm.clear_table(\"purchase_receipt_item_print\");\ncur_frm.refresh()\nvar flag=0;\n\nvar newrow = frappe.model.add_child(cur_frm.doc,\"Purchase Receipt Item Print\", \"purchase_receipt_item_print\");\nnewrow.item_code = cur_frm.doc.items[0].item_code\nnewrow.item_name = cur_frm.doc.items[0].item_name\nnewrow.received_quantity = cur_frm.doc.items[0].received_qty\nnewrow.accepted_quantity = cur_frm.doc.items[0].qty\nnewrow.rejected_quantity = cur_frm.doc.items[0].rejected_qty\n\n\nfor (i = 1; i < cur_frm.doc.items.length; i++) { \nfor (j = 0; j < cur_frm.doc.purchase_receipt_item_print.length; j++) { \nif (cur_frm.doc.items[i].item_code == cur_frm.doc.purchase_receipt_item_print[j].item_code && cur_frm.doc.items[i].item_name == cur_frm.doc.purchase_receipt_item_print[j].item_name)\n{\nflag = 1;\ncur_frm.doc.purchase_receipt_item_print[j].received_quantity = cur_frm.doc.purchase_receipt_item_print[j].received_quantity+cur_frm.doc.items[i].received_qty;\ncur_frm.doc.purchase_receipt_item_print[j].accepted_quantity = cur_frm.doc.purchase_receipt_item_print[j].accepted_quantity +cur_frm.doc.items[i].qty;\ncur_frm.doc.purchase_receipt_item_print[j].rejected_quantity = cur_frm.doc.purchase_receipt_item_print[j].rejected_quantity +cur_frm.doc.items[i].rejected_qty;\nrefresh_field(\"purchase_receipt_item_print\");\n}\n}\nif(flag != 1)\n{\nvar newrow = frappe.model.add_child(cur_frm.doc,\"Purchase Receipt Item Print\", \"purchase_receipt_item_print\");\nnewrow.item_code = cur_frm.doc.items[i].item_code\nnewrow.item_name = cur_frm.doc.items[i].item_name\nnewrow.received_quantity = cur_frm.doc.items[i].received_qty\nnewrow.accepted_quantity = cur_frm.doc.items[i].qty\nnewrow.rejected_quantity = cur_frm.doc.items[i].rejected_qty}\nflag=0;\n}\n\n\n\n});\n", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Warranty Claim", 
  "modified": "2016-12-10 15:56:03.768616", 
  "name": "Warranty Claim-Client", 
  "script": "cur_frm.add_fetch(\"complaint_number\", \"customer_name_custom\", \"customer\");\ncur_frm.add_fetch(\"complaint_number\", \"customer_full_name\", \"customer_full_name\");\ncur_frm.add_fetch(\"complaint_number\", \"branch\", \"selco_branch\"); \n\ncur_frm.add_fetch(\"selco_item_code2\", \"item_name\", \"selco_item_name\");\ncur_frm.add_fetch(\"selco_item_code2\", \"item_group\", \"item_group\");\ncur_frm.add_fetch(\"selco_item_code2\", \"description\", \"item_description\");\n\ncur_frm.add_fetch(\"selco_panel_capacity\", \"item_name\", \"selco_panel_name\");\ncur_frm.add_fetch(\"selco_battery_capacity\", \"item_name\", \"selco_battery_name\"); \ncur_frm.add_fetch(\"selco_inverter_capacity\", \"item_name\", \"selco_inverter_name\"); \ncur_frm.add_fetch(\"selco_water_heater_capacity\", \"item_name\", \"selco_water_heater_name\"); \n\n\nfrappe.ui.form.on(\"Warranty Claim\", \"selco_panel\", function(frm) {\n    cur_frm.set_query(\"selco_item_code2\", function() {\n        return {\n            \"filters\": {\n                \"item_group\": \"Modules\"\n            }\n        };\n    });\n    cur_frm.set_query(\"supplier\", function() {\n        return {\n            \"filters\": {\n                \"supplier_type\": \"Module Manufacturer\"\n            }\n        };\n    });\n});\n\n\n\nfrappe.ui.form.on(\"Warranty Claim\", \"selco_battery\", function(frm) {\n    cur_frm.set_query(\"selco_item_code2\", function() {\n        return {\n            \"filters\": {\n                \"item_group\": \"Batteries\"\n            }\n        };\n    });\n    cur_frm.set_query(\"supplier\", function() {\n        return {\n            \"filters\": {\n                \"supplier_type\": \"Battery Manufacturer\"\n            }\n        };\n    });\n});\n\n\nfrappe.ui.form.on(\"Warranty Claim\", \"selco_inverter\", function(frm) {\n    cur_frm.set_query(\"selco_item_code2\", function() {\n        return {\n            \"filters\": {\n                \"item_group\": \"Inverters\"\n            }\n        };\n    });\n    cur_frm.set_query(\"supplier\", function() {\n        return {\n            \"filters\": {\n                \"supplier_type\": \"Inverter Manufacturer\"\n            }\n        };\n    });\n});\n\n\nfrappe.ui.form.on(\"Warranty Claim\", \"selco_water_heater\", function(frm) {\n    cur_frm.set_query(\"selco_item_code2\", function() {\n        return {\n            \"filters\": {\n                \"item_group\": \"ETC Water Heater Systems\"\n            }\n        };\n    });\n    cur_frm.set_query(\"supplier\", function() {\n        return {\n            \"filters\": {\n                \"supplier_type\": \"Solar Water Heater ETC Manufacturer\"\n            }\n        };\n    });\n});\n\n\nfrappe.ui.form.on(\"Warranty Claim\", \"validate\", function(frm) {\n        if ( cur_frm.doc.workflow_state==\"Warranty Claim Format Raised - WC\")\n        {\n        frappe.call({\n            \"method\": \"frappe.client.set_value\",\n            \"args\": {\n                \"doctype\": \"Issue\",\n                \"name\": frm.doc.complaint_number,\n                \"fieldname\": \"workflow_state\",\n                \"value\": \"Warranty Claim Format Raised - WC\"\n            }\n        });\n        }\n});\nfrappe.ui.form.on(\"Warranty Claim\", \"validate\", function(frm) {\n        if ( cur_frm.doc.workflow_state==\"Warranty Claim Approved - WC\")\n        {\n        frappe.call({\n            \"method\": \"frappe.client.set_value\",\n            \"args\": {\n                \"doctype\": \"Issue\",\n                \"name\": frm.doc.complaint_number,\n                \"fieldname\": \"workflow_state\",\n                \"value\": \"Dispatch Pending From Godown\"\n            }\n        });\n        }\n});\n\nfrappe.ui.form.on(\"Warranty Claim\", \"validate\", function(frm) {\n        if ( cur_frm.doc.workflow_state==\"Warranty Claim Rejected - WC\")\n        {\n        frappe.call({\n            \"method\": \"frappe.client.set_value\",\n            \"args\": {\n                \"doctype\": \"Issue\",\n                \"name\": frm.doc.complaint_number,\n                \"fieldname\": \"workflow_state\",\n                \"value\": \"Complaint Attended By CSE - Still Open\"\n            }\n        });\n        }\n});\n\n\nfrappe.ui.form.on(\"Warranty Claim\", \"validate\", function(frm) {\n        if ( cur_frm.doc.workflow_state==\"Dispatched From Godown\")\n        {\n        frappe.call({\n            \"method\": \"frappe.client.set_value\",\n            \"args\": {\n                \"doctype\": \"Issue\",\n                \"name\": frm.doc.complaint_number,\n                \"fieldname\": \"workflow_state\",\n                \"value\": \"Dispatched From Godown\"\n            }\n        });\n        }\n});\n\n\nfrappe.ui.form.on(\"Warranty Claim\", \"selco_branch\", function(frm, cdt, cdn) {\n\tvar d = locals[cdt][cdn];\n\tfrappe.call({\n\t\t\"method\": \"frappe.client.get\",\n\t\targs: {\n\t\t\tdoctype: \"Branch\",\n\t\t\tname: d.selco_branch\n\t\t},\n\t\tcallback: function (data) {\n\t\t\tfrappe.model.set_value(d.doctype, d.name, \"godown_email_id\", data.message.godown_email_id);\n\n\t\t}\n\t})\n});\n\nfrappe.ui.form.on(\"Warranty Claim\", \"selco_branch\", function(frm, cdt, cdn) {\n\tvar d = locals[cdt][cdn];\n\tfrappe.call({\n\t\t\"method\": \"frappe.client.get\",\n\t\targs: {\n\t\t\tdoctype: \"Branch\",\n\t\t\tname: d.selco_branch\n\t\t},\n\t\tcallback: function (data) {\n\t\t\tfrappe.model.set_value(d.doctype, d.name, \"senior_service_manager_email_id\",data.message.senior_service_manager_email_id);\n\n\t\t}\n\t})\n});\n\n\nfrappe.ui.form.on(\"Warranty Claim\", \"refresh\",\n    function(frm) {\nif ( cur_frm.doc.workflow_state == \"Warranty Claim Format Raised - WC\" || cur_frm.doc.workflow_state == \"Warranty Claim Approved - WC\" || cur_frm.doc.workflow_state == \"Warranty Claim Rejected - WC\" || cur_frm.doc.workflow_state == \"Dispatched From Godown\")\n{\ncur_frm.fields.forEach(function(l){ cur_frm.set_df_property(l.df.fieldname, \"read_only\", 1); })\nfrm.set_df_property(\"dc_number\", \"read_only\",0);\nfrm.set_df_property(\"remarks_by_godown\", \"read_only\",0);\n\n\nfrm.set_df_property(\"selco_item_code2\", \"read_only\",0);\nfrm.set_df_property(\"selco_item_name\", \"read_only\",0);\nfrm.set_df_property(\"item_serial_number\", \"read_only\",0);\nfrm.set_df_property(\"supplier\", \"read_only\",0);\nfrm.set_df_property(\"within_warranty\", \"read_only\",0);\n\n\n}\n})\n\n/*frappe.ui.form.on(\"Warranty Claim\", \"validate\", function(frm) {\n        frappe.call({\n            \"method\": \"frappe.client.set_value\",\n            \"args\": {\n                \"doctype\": \"Issue\",\n                \"name\": frm.doc.complaint_number,\n                \"fieldname\": \"capacity\",\n                \"value\": \"test\"\n            },\n\tcallback: function (r){\n\tmsgprint(\"Successfully Set number\");\n\t}\n        });\n});\n*/\n\n\n", 
  "script_type": "Client"
 }
]